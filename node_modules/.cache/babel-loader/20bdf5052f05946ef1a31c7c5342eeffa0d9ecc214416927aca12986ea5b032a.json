{"ast":null,"code":"/**\r\n * @license\r\n * Copyright (c) 2025 Handsoncode. All rights reserved.\r\n */\nimport { CellError, ErrorType } from \"../../Cell.mjs\";\nimport { ErrorMessage } from \"../../error-message.mjs\";\nimport { FunctionArgumentType, FunctionPlugin } from \"./FunctionPlugin.mjs\";\nexport class RandomPlugin extends FunctionPlugin {\n  /**\r\n   * Corresponds to RAND()\r\n   *\r\n   * Returns a pseudo-random floating-point random number\r\n   * in the range [0,1).\r\n   *\r\n   * @param ast\r\n   * @param state\r\n   */\n  rand(ast, state) {\n    return this.runFunction(ast.args, state, this.metadata('RAND'), Math.random);\n  }\n  randbetween(ast, state) {\n    return this.runFunction(ast.args, state, this.metadata('RANDBETWEEN'), (lower, upper) => {\n      if (upper < lower) {\n        return new CellError(ErrorType.NUM, ErrorMessage.WrongOrder);\n      }\n      lower = Math.ceil(lower);\n      upper = Math.floor(upper) + 1;\n      if (lower === upper) {\n        upper += 1;\n      }\n      return lower + Math.floor(Math.random() * (upper - lower));\n    });\n  }\n}\nRandomPlugin.implementedFunctions = {\n  'RAND': {\n    method: 'rand',\n    parameters: [],\n    isVolatile: true\n  },\n  'RANDBETWEEN': {\n    method: 'randbetween',\n    parameters: [{\n      argumentType: FunctionArgumentType.NUMBER\n    }, {\n      argumentType: FunctionArgumentType.NUMBER\n    }],\n    isVolatile: true\n  }\n};","map":{"version":3,"names":["CellError","ErrorType","ErrorMessage","FunctionArgumentType","FunctionPlugin","RandomPlugin","rand","ast","state","runFunction","args","metadata","Math","random","randbetween","lower","upper","NUM","WrongOrder","ceil","floor","implementedFunctions","method","parameters","isVolatile","argumentType","NUMBER"],"sources":["C:/spreadsheet-clone/node_modules/hyperformula/es/interpreter/plugin/RandomPlugin.mjs"],"sourcesContent":["/**\r\n * @license\r\n * Copyright (c) 2025 Handsoncode. All rights reserved.\r\n */\nimport { CellError, ErrorType } from \"../../Cell.mjs\";\nimport { ErrorMessage } from \"../../error-message.mjs\";\nimport { FunctionArgumentType, FunctionPlugin } from \"./FunctionPlugin.mjs\";\nexport class RandomPlugin extends FunctionPlugin {\n  /**\r\n   * Corresponds to RAND()\r\n   *\r\n   * Returns a pseudo-random floating-point random number\r\n   * in the range [0,1).\r\n   *\r\n   * @param ast\r\n   * @param state\r\n   */\n  rand(ast, state) {\n    return this.runFunction(ast.args, state, this.metadata('RAND'), Math.random);\n  }\n  randbetween(ast, state) {\n    return this.runFunction(ast.args, state, this.metadata('RANDBETWEEN'), (lower, upper) => {\n      if (upper < lower) {\n        return new CellError(ErrorType.NUM, ErrorMessage.WrongOrder);\n      }\n      lower = Math.ceil(lower);\n      upper = Math.floor(upper) + 1;\n      if (lower === upper) {\n        upper += 1;\n      }\n      return lower + Math.floor(Math.random() * (upper - lower));\n    });\n  }\n}\nRandomPlugin.implementedFunctions = {\n  'RAND': {\n    method: 'rand',\n    parameters: [],\n    isVolatile: true\n  },\n  'RANDBETWEEN': {\n    method: 'randbetween',\n    parameters: [{\n      argumentType: FunctionArgumentType.NUMBER\n    }, {\n      argumentType: FunctionArgumentType.NUMBER\n    }],\n    isVolatile: true\n  }\n};"],"mappings":"AAAA;AACA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,SAAS,QAAQ,gBAAgB;AACrD,SAASC,YAAY,QAAQ,yBAAyB;AACtD,SAASC,oBAAoB,EAAEC,cAAc,QAAQ,sBAAsB;AAC3E,OAAO,MAAMC,YAAY,SAASD,cAAc,CAAC;EAC/C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEE,IAAIA,CAACC,GAAG,EAAEC,KAAK,EAAE;IACf,OAAO,IAAI,CAACC,WAAW,CAACF,GAAG,CAACG,IAAI,EAAEF,KAAK,EAAE,IAAI,CAACG,QAAQ,CAAC,MAAM,CAAC,EAAEC,IAAI,CAACC,MAAM,CAAC;EAC9E;EACAC,WAAWA,CAACP,GAAG,EAAEC,KAAK,EAAE;IACtB,OAAO,IAAI,CAACC,WAAW,CAACF,GAAG,CAACG,IAAI,EAAEF,KAAK,EAAE,IAAI,CAACG,QAAQ,CAAC,aAAa,CAAC,EAAE,CAACI,KAAK,EAAEC,KAAK,KAAK;MACvF,IAAIA,KAAK,GAAGD,KAAK,EAAE;QACjB,OAAO,IAAIf,SAAS,CAACC,SAAS,CAACgB,GAAG,EAAEf,YAAY,CAACgB,UAAU,CAAC;MAC9D;MACAH,KAAK,GAAGH,IAAI,CAACO,IAAI,CAACJ,KAAK,CAAC;MACxBC,KAAK,GAAGJ,IAAI,CAACQ,KAAK,CAACJ,KAAK,CAAC,GAAG,CAAC;MAC7B,IAAID,KAAK,KAAKC,KAAK,EAAE;QACnBA,KAAK,IAAI,CAAC;MACZ;MACA,OAAOD,KAAK,GAAGH,IAAI,CAACQ,KAAK,CAACR,IAAI,CAACC,MAAM,CAAC,CAAC,IAAIG,KAAK,GAAGD,KAAK,CAAC,CAAC;IAC5D,CAAC,CAAC;EACJ;AACF;AACAV,YAAY,CAACgB,oBAAoB,GAAG;EAClC,MAAM,EAAE;IACNC,MAAM,EAAE,MAAM;IACdC,UAAU,EAAE,EAAE;IACdC,UAAU,EAAE;EACd,CAAC;EACD,aAAa,EAAE;IACbF,MAAM,EAAE,aAAa;IACrBC,UAAU,EAAE,CAAC;MACXE,YAAY,EAAEtB,oBAAoB,CAACuB;IACrC,CAAC,EAAE;MACDD,YAAY,EAAEtB,oBAAoB,CAACuB;IACrC,CAAC,CAAC;IACFF,UAAU,EAAE;EACd;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}